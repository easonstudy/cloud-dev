webpackJsonp([16],{710:function(e,t,r){r(916);var s=r(52)(r(863),r(941),"data-v-216fa986",null);e.exports=s.exports},847:function(e,t,r){"use strict";var s=r(276);t.a={entity:{id:0,type:0,code:"",name:"",score:0,number:0,url:"",isDelete:0,updateBy:"",createBy:""},update:function(e){return s.a("/api/v1/gift/merge",e)},remove:function(e){return s.d("/api/v1/gift/"+e)},findList:function(e){return s.a("/api/v1/gift/list",e)},searchList:function(e){return s.a("/api/v1/gift/searchList",e)},exchange:function(e){return s.f("/api/v1/gift/exchange",e,{})},findExchangeList:function(e,t){return s.f("/api/v1/gift/exchange/list",e,t)}}},863:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r(149),a=r.n(s),o=r(150),i=r.n(o),n=r(847),l=r(100);t.default={data:function(){return{user:{userUniqueId:"",nickName:"",phone:"",score:""},filters:{filterStr:""},rows:[],total:0,page:1,limit:10,currentPage:1,editFormVisible:!1,editForm:{userUniqueId:"",userScore:0,id:0,code:"",name:"",score:0,number:0},editRules:{}}},methods:{onSearchSubmit:function(){var e=this;if(this.user.nickName="",this.user.phone="",this.user.score="",""==e.user.userUniqueId)return void e.$message.error({showClose:!0,message:"请输入会员信息",duration:2e3});l.a.search(e.user.userUniqueId).then(function(t){console.log("search user:"+i()(t)),void 0==t||null==t?e.$message.error({showClose:!0,message:"未找到该用户",duration:2e3}):(e.user.nickName=t.nickName,e.user.phone=t.phone,e.user.score=null!=t.userBalance?t.userBalance.score:0)},function(t){e.$message.error({showClose:!0,message:t.toString(),duration:2e3})}).catch(function(t){e.$message.error({showClose:!0,message:"请求出现异常",duration:2e3})})},handleSizeChange:function(e){this.limit=e(),this.search()},handleCurrentChange:function(e){this.page=e,this.search()},search:function(){var e=this,t={pageNum:e.page,pageSize:e.limit};e.loading=!0;var r={filterStr:e.filters.filterStr};t=a()(t,r),console.log(i()(t)),n.a.searchList(t).then(function(t){e.loading=!1,t&&t.data&&(e.total=t.data.total,e.rows=t.data.list)},function(t){e.loading=!1,e.$message.error({showClose:!0,message:t.toString(),duration:2e3})}).catch(function(t){e.loading=!1,console.log(t),e.$message.error({showClose:!0,message:"请求出现异常",duration:2e3})})},showEditDialog:function(e,t){return 0==t.number?void this.$message({showClose:!0,message:"礼品已兑完",type:"error"}):""==this.user.phone?void this.$message({showClose:!0,message:"请先查找会员",type:"error"}):(this.editFormVisible=!0,this.editTitle="兑换礼品",this.editForm=a()({},t),this.editForm.userUniqueId=this.user.phone,this.editForm.userScore=this.user.score,void(this.editForm.number=1))},editSubmit:function(){var e=this;if(e.editForm.score*e.editForm.number>e.editForm.userScore)return void e.$message.error({showClose:!0,message:"积分不足",duration:2e3});this.$refs.editForm.validate(function(t){if(t){var r=a()({},e.editForm);n.a.exchange(r).then(function(t){console.log("result:"+i()(t)),t&&0==parseInt(t.errorCode)&&(e.$message.success({showClose:!0,message:"兑换成功",duration:3e3}),e.editFormVisible=!1,e.search())},function(t){e.loading=!1,e.$message.error({showClose:!0,message:t.toString(),duration:2e3})}).catch(function(t){e.loading=!1,console.log(t),e.$message.error({showClose:!0,message:"请求出现异常",duration:2e3})})}})}},mounted:function(){}}},890:function(e,t,r){t=e.exports=r(700)(),t.push([e.i,".message[data-v-216fa986]{font-size:18}","",{version:3,sources:["C:/Users/guo/workspace/idea/cloud-dev/member-fms/src/components/score/exchange.vue"],names:[],mappings:"AACA,0BACE,YAAa,CACd",file:"exchange.vue",sourcesContent:["\n.message[data-v-216fa986] {\n  font-size: 18\n}\n"],sourceRoot:""}])},916:function(e,t,r){var s=r(890);"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);r(701)("deedd3de",s,!0)},941:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-row",{staticClass:"warp"},[r("el-col",{staticClass:"warp-breadcrum",attrs:{span:24}},[r("el-breadcrumb",{attrs:{separator:"/"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[r("b",[e._v("首页")])]),e._v(" "),r("el-breadcrumb-item",[e._v("积分管理")]),e._v(" "),r("el-breadcrumb-item",[e._v("礼品兑换")])],1)],1),e._v(" "),r("el-col",{staticClass:"warp-breadcrum",attrs:{span:24}},[r("el-col",{attrs:{span:6}},[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("查找会员")])]),e._v(" "),r("el-form",{attrs:{inline:!0,model:e.user}},[r("el-form-item",{attrs:{label:"会员"}},[r("el-input",{attrs:{placeholder:"电话/ID/唯一标记"},model:{value:e.user.userUniqueId,callback:function(t){e.$set(e.user,"userUniqueId",t)},expression:"user.userUniqueId"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.onSearchSubmit}},[e._v("查找")])],1),e._v(" "),r("br"),e._v(" "),r("el-form-item",{attrs:{label:"昵称:"}},[e._v("\n            "+e._s(e.user.nickName)+"\n            ")]),e._v(" "),r("el-form-item",{attrs:{label:"电话:"}},[e._v("\n            "+e._s(e.user.phone)+"\n            ")]),e._v(" "),r("el-form-item",{attrs:{label:"积分:"}},[e._v("\n            "+e._s(e.user.score)+"\n            ")])],1)],1)],1),e._v(" "),r("el-col",{attrs:{span:18}},[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("查找礼品")])]),e._v(" "),r("div",[r("el-col",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24,"element-loading-text":"拼命加载中"}},[r("el-form",{attrs:{inline:!0,model:e.filters}},[r("el-form-item",[r("el-input",{staticStyle:{"min-width":"240px"},attrs:{placeholder:"商品(编号/名称)"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.onFilterSubmit(t)}},model:{value:e.filters.filterStr,callback:function(t){e.$set(e.filters,"filterStr",t)},expression:"filters.filterStr"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查询")])],1)],1),e._v(" "),r("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:e.rows,"highlight-current-row":""}},[r("el-table-column",{attrs:{prop:"code",label:"商品编号",sortable:""}}),e._v(" "),r("el-table-column",{attrs:{prop:"name",label:"商品名称",sortable:""}}),e._v(" "),r("el-table-column",{attrs:{prop:"score",label:"所需积分",sortable:""}}),e._v(" "),r("el-table-column",{attrs:{prop:"number",label:"剩余数量",sortable:""}}),e._v(" "),r("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:function(r){e.showEditDialog(t.$index,t.row)}}},[e._v("\n                    兑换\n                  ")])]}}])})],1),e._v(" "),r("el-col",{staticClass:"toolbar",attrs:{span:24}},[r("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"prev, pager, next","page-size":e.limit,total:e.total},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),r("el-dialog",{attrs:{title:e.editTitle,visible:e.editFormVisible,"before-close":e.editDiaglogClose,"close-on-click-modal":!1},on:{"update:visible":function(t){e.editFormVisible=t}}},[r("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.editRules,"label-width":"100px"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"礼品名称:"}},[e._v("\n                      "+e._s(e.editForm.name)+"\n                      ")])],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"礼品编号:"}},[e._v("\n                      "+e._s(e.editForm.code)+"\n                      ")])],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"所需积分"}},[e._v("\n                      "+e._s(e.editForm.score)+"\n                      ")])],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"会员:",prop:"userUniqueId"}},[e._v("\n                      "+e._s(e.editForm.userUniqueId)+"\n                    ")])],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"可用积分:",prop:"userScore"}},[e._v("\n                      "+e._s(e.editForm.userScore)+"\n                    ")])],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"兑换数量"}},[r("el-input",{attrs:{type:"number","auto-complete":"off"},model:{value:e.editForm.number,callback:function(t){e.$set(e.editForm,"number",t)},expression:"editForm.number"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"总花费积分:"}},[e._v("\n                      "+e._s(e.editForm.number*e.editForm.score)+"\n                    ")])],1)],1),e._v(" "),r("el-form-item",[r("el-button",{nativeOn:{click:function(t){e.editFormVisible=!1}}},[e._v("取消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){e.editSubmit(t)}}},[e._v("兑换")])],1)],1)],1)],1)],1)])],1)],1)],1)},staticRenderFns:[]}}});
//# sourceMappingURL=16.2a6a159bdfa46f67c587.js.map