{"version":3,"sources":["webpack:///box/js/7.9ddf27df2ce98df212d8.js","webpack:///./src/components/staff/role.vue","webpack:///./src/api/api_role.js?0044","webpack:///role.vue","webpack:///./src/components/staff/role.vue?79f6","webpack:///./src/components/staff/role.vue?60aa","webpack:///./src/components/staff/role.vue?62ad"],"names":["webpackJsonp","710","module","exports","__webpack_require__","Component","840","__webpack_exports__","__WEBPACK_IMPORTED_MODULE_0____","findList","params","permissionsList","permissionsUpdate","id","permissionsGet","852","Object","defineProperty","value","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default","n","__WEBPACK_IMPORTED_MODULE_1__api_api_role__","data","loading","permissionsEditLoading","users","total","page","limit","currentPage","editFormVisible","editPermissionsFormVisible","editId","treeData","defaultProps","children","label","methods","handleSizeChange","val","this","search","handleCurrentChange","handleSearch","that","pageNum","pageSize","then","result","list","err","$message","error","showClose","message","toString","duration","catch","console","log","handleDefaultPermissions","permissionsLoading","errorCode","i","item","Number","level","redirect","push","_item","p","d","dobj","parentId","showEditDialog","index","row","showPermissionsDialog","editPermissionsSubmit","para","$refs","tree","getCheckedKeys","keys","parseInt","success","mounted","updated","setCheckedNodes","864","version","sources","names","mappings","file","sourceRoot","876","content","locals","888","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","span","separator","to","path","_v","directives","name","rawName","expression","element-loading-text","staticStyle","width","stripe","highlight-current-row","type","prop","sortable","fixed","scopedSlots","_u","key","fn","scope","size","on","click","$event","$index","delRole","float","layout","page-size","current-change","title","visible","close-on-click-modal","update:visible","domProps","ref","show-checkbox","default-expand-all","node-key","highlight-current","props","slot","nativeOn","staticRenderFns"],"mappings":"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","file":"box/js/7.9ddf27df2ce98df212d8.js","sourcesContent":["webpackJsonp([7],{\n\n/***/ 710:\n/***/ (function(module, exports, __webpack_require__) {\n\n\n/* styles */\n__webpack_require__(876)\n\nvar Component = __webpack_require__(52)(\n  /* script */\n  __webpack_require__(852),\n  /* template */\n  __webpack_require__(888),\n  /* scopeId */\n  \"data-v-357af519\",\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n\n/***/ 840:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0____ = __webpack_require__(276);\n\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n  findList: function findList(params) {\n    return __WEBPACK_IMPORTED_MODULE_0____[\"b\" /* GET */]('/api/v1/role/list', params);\n  },\n\n  permissionsList: function permissionsList(params) {\n    return __WEBPACK_IMPORTED_MODULE_0____[\"b\" /* GET */]('/api/v1/permissions/list', params);\n  },\n\n  permissionsUpdate: function permissionsUpdate(id, params) {\n    return __WEBPACK_IMPORTED_MODULE_0____[\"a\" /* POST */]('/api/v1/role/permissions/update/' + id, params);\n  },\n\n  permissionsGet: function permissionsGet(id, params) {\n    return __WEBPACK_IMPORTED_MODULE_0____[\"b\" /* GET */]('/api/v1/role/permissions/' + id, params);\n  }\n\n});\n\n/***/ }),\n\n/***/ 852:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__ = __webpack_require__(149);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__api_api_role__ = __webpack_require__(840);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__utils_session__ = __webpack_require__(151);\n\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  data: function data() {\n    return {\n      loading: false,\n      permissionsEditLoading: false,\n      users: [],\n      total: 0,\n      page: 1,\n      limit: 10,\n      currentPage: 1,\n\n      editFormVisible: false,\n      editPermissionsFormVisible: false,\n      editId: 0,\n      treeData: [],\n      defaultProps: {\n        children: 'children',\n        label: 'name'\n      }\n    };\n  },\n\n  methods: {\n    handleSizeChange: function handleSizeChange(val) {\n      this.limit = val();\n      this.search();\n    },\n    handleCurrentChange: function handleCurrentChange(val) {\n      this.page = val;\n      this.search();\n    },\n    handleSearch: function handleSearch() {\n      this.total = 0;\n      this.page = 1;\n      this.search();\n    },\n\n    search: function search() {\n      var that = this;\n      var params = {\n        pageNum: that.page,\n        pageSize: that.limit\n      };\n\n      that.loading = true;\n      __WEBPACK_IMPORTED_MODULE_1__api_api_role__[\"a\" /* default */].findList(params).then(function (result) {\n        that.loading = false;\n        if (result && result.data) {\n          that.total = result.data.total;\n          that.users = result.data.list;\n        }\n      }, function (err) {\n        that.loading = false;\n        that.$message.error({ showClose: true, message: err.toString(), duration: 2000 });\n      }).catch(function (error) {\n        that.loading = false;\n        console.log(error);\n        that.$message.error({ showClose: true, message: '请求出现异常', duration: 2000 });\n      });\n    },\n\n    handleDefaultPermissions: function handleDefaultPermissions() {\n      var that = this;\n      var params = {\n        pageNum: that.page,\n        pageSize: 100\n      };\n\n      __WEBPACK_IMPORTED_MODULE_1__api_api_role__[\"a\" /* default */].permissionsList(params).then(function (result) {\n        console.log(\"获取树结构\");\n        that.permissionsLoading = false;\n        if (result && result.errorCode == 0) {\n          var list = result.data.list;\n\n          var data = [];\n\n          for (var i in list) {\n            var item = list[i];\n            if (Number(item.level) == 1) {\n              if (item.redirect == null) {\n                delete item.redirect;\n              }\n\n              item.children = [];\n              data.push(item);\n            }\n          }\n\n          for (var i in list) {\n            var _item = list[i];\n            if (Number(_item.level) == 2) {\n              var p = {};\n              for (var d in data) {\n                var dobj = data[d];\n                if (dobj.id == _item.parentId) {\n                  p = dobj;\n                  break;\n                }\n              }\n              if (_item.redirect == null) {\n                delete _item.redirect;\n              }\n              p.children.push(_item);\n            }\n          }\n          that.treeData = data;\n        }\n      }, function (err) {\n        that.$message.error({ showClose: true, message: err.toString(), duration: 2000 });\n      }).catch(function (error) {\n        that.$message.error({ showClose: true, message: '请求出现异常', duration: 2000 });\n      });\n    },\n\n    showEditDialog: function showEditDialog(index, row) {\n      this.editFormVisible = true;\n      console.log(row);\n    },\n\n    showPermissionsDialog: function showPermissionsDialog(index, row) {\n      this.editPermissionsFormVisible = true;\n      this.editId = row.id;\n\n      this.permissionsEditLoading = true;\n    },\n\n    editPermissionsSubmit: function editPermissionsSubmit() {\n      var that = this;\n      var para = that.$refs.tree.getCheckedKeys();\n\n      that.loading = true;\n      __WEBPACK_IMPORTED_MODULE_1__api_api_role__[\"a\" /* default */].permissionsUpdate(that.editId, { 'keys': para.toString() }).then(function (result) {\n        that.loading = false;\n\n        if (result && parseInt(result.errorCode) == 0) {\n          that.$message.success({ showClose: true, message: '修改成功', duration: 2000 });\n          that.editPermissionsFormVisible = false;\n        } else {\n          that.$message.error({ showClose: true, message: '修改失败', duration: 2000 });\n        }\n      }, function (err) {\n        that.loading = false;\n        that.$message.error({ showClose: true, message: err.toString(), duration: 2000 });\n      }).catch(function (error) {\n        that.loading = false;\n        console.log(error);\n        that.$message.error({ showClose: true, message: '请求出现异常', duration: 2000 });\n      });\n    }\n\n  },\n  mounted: function mounted() {\n    this.handleSearch();\n    this.handleDefaultPermissions();\n  },\n  updated: function updated() {\n    var that = this;\n\n    if (that.permissionsEditLoading == true) {\n      __WEBPACK_IMPORTED_MODULE_1__api_api_role__[\"a\" /* default */].permissionsGet(that.editId, {}).then(function (result) {\n        console.log(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(result));\n        that.$refs.tree.setCheckedNodes(result.data);\n      });\n    }\n  }\n});\n\n/***/ }),\n\n/***/ 864:\n/***/ (function(module, exports, __webpack_require__) {\n\nexports = module.exports = __webpack_require__(700)();\n// imports\n\n\n// module\nexports.push([module.i, \"\", \"\", {\"version\":3,\"sources\":[],\"names\":[],\"mappings\":\"\",\"file\":\"role.vue\",\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n/***/ }),\n\n/***/ 876:\n/***/ (function(module, exports, __webpack_require__) {\n\n// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = __webpack_require__(864);\nif(typeof content === 'string') content = [[module.i, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = __webpack_require__(701)(\"5de68f1c\", content, true);\n\n/***/ }),\n\n/***/ 888:\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('el-row', {\n    staticClass: \"warp\"\n  }, [_c('el-col', {\n    staticClass: \"warp-breadcrum\",\n    attrs: {\n      \"span\": 24\n    }\n  }, [_c('el-breadcrumb', {\n    attrs: {\n      \"separator\": \"/\"\n    }\n  }, [_c('el-breadcrumb-item', {\n    attrs: {\n      \"to\": {\n        path: '/'\n      }\n    }\n  }, [_c('b', [_vm._v(\"首页\")])]), _vm._v(\" \"), _c('el-breadcrumb-item', [_vm._v(\"系统管理\")]), _vm._v(\" \"), _c('el-breadcrumb-item', [_vm._v(\"管理员列表\")])], 1)], 1), _vm._v(\" \"), _c('el-col', {\n    directives: [{\n      name: \"loading\",\n      rawName: \"v-loading\",\n      value: (_vm.loading),\n      expression: \"loading\"\n    }],\n    staticClass: \"warp-main\",\n    attrs: {\n      \"span\": 24,\n      \"element-loading-text\": \"拼命加载中\"\n    }\n  }, [_c('el-table', {\n    staticStyle: {\n      \"width\": \"100%\"\n    },\n    attrs: {\n      \"stripe\": \"\",\n      \"data\": _vm.users,\n      \"highlight-current-row\": \"\"\n    }\n  }, [_c('el-table-column', {\n    attrs: {\n      \"type\": \"index\",\n      \"width\": \"40\"\n    }\n  }), _vm._v(\" \"), _c('el-table-column', {\n    attrs: {\n      \"prop\": \"name\",\n      \"label\": \"角色\",\n      \"width\": \"120\",\n      \"sortable\": \"\"\n    }\n  }), _vm._v(\" \"), _c('el-table-column', {\n    attrs: {\n      \"prop\": \"remark\",\n      \"label\": \"备注\",\n      \"sortable\": \"\"\n    }\n  }), _vm._v(\" \"), _c('el-table-column', {\n    attrs: {\n      \"fixed\": \"right\",\n      \"width\": \"280\",\n      \"label\": \"操作\"\n    },\n    scopedSlots: _vm._u([{\n      key: \"default\",\n      fn: function(scope) {\n        return [_c('el-button', {\n          attrs: {\n            \"size\": \"small\"\n          },\n          on: {\n            \"click\": function($event) {\n              _vm.showPermissionsDialog(scope.$index, scope.row)\n            }\n          }\n        }, [_vm._v(\"编辑权限\")]), _vm._v(\" \"), _c('el-button', {\n          attrs: {\n            \"type\": \"danger\",\n            \"size\": \"small\"\n          },\n          on: {\n            \"click\": function($event) {\n              _vm.delRole(scope.$index, scope.row)\n            }\n          }\n        }, [_vm._v(\"删除\")])]\n      }\n    }])\n  })], 1), _vm._v(\" \"), _c('el-col', {\n    staticClass: \"toolbar\",\n    attrs: {\n      \"span\": 24\n    }\n  }, [_c('el-pagination', {\n    staticStyle: {\n      \"float\": \"right\"\n    },\n    attrs: {\n      \"layout\": \"prev, pager, next\",\n      \"page-size\": _vm.limit,\n      \"total\": _vm.total\n    },\n    on: {\n      \"current-change\": _vm.handleCurrentChange\n    }\n  })], 1), _vm._v(\" \"), _c('el-dialog', {\n    attrs: {\n      \"title\": \"编辑权限\",\n      \"visible\": _vm.editPermissionsFormVisible,\n      \"close-on-click-modal\": false\n    },\n    on: {\n      \"update:visible\": function($event) {\n        _vm.editPermissionsFormVisible = $event\n      }\n    }\n  }, [_c('input', {\n    attrs: {\n      \"type\": \"hidden\"\n    },\n    domProps: {\n      \"value\": _vm.editId\n    }\n  }), _vm._v(\" \"), _c('el-tree', {\n    ref: \"tree\",\n    attrs: {\n      \"data\": _vm.treeData,\n      \"show-checkbox\": \"\",\n      \"default-expand-all\": \"\",\n      \"node-key\": \"id\",\n      \"highlight-current\": \"\",\n      \"props\": _vm.defaultProps\n    }\n  }), _vm._v(\" \"), _c('div', {\n    staticClass: \"dialog-footer\",\n    attrs: {\n      \"slot\": \"footer\"\n    },\n    slot: \"footer\"\n  }, [_c('el-button', {\n    nativeOn: {\n      \"click\": function($event) {\n        _vm.editPermissionsFormVisible = false\n      }\n    }\n  }, [_vm._v(\"取消\")]), _vm._v(\" \"), _c('el-button', {\n    attrs: {\n      \"type\": \"primary\"\n    },\n    nativeOn: {\n      \"click\": function($event) {\n        _vm.editPermissionsSubmit($event)\n      }\n    }\n  }, [_vm._v(\"提交\")])], 1)], 1)], 1)], 1)\n},staticRenderFns: []}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// box/js/7.9ddf27df2ce98df212d8.js","\n/* styles */\nrequire(\"!!../../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"id\\\":\\\"data-v-357af519\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./role.vue\")\n\nvar Component = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./role.vue\"),\n  /* template */\n  require(\"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-357af519\\\"}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./role.vue\"),\n  /* scopeId */\n  \"data-v-357af519\",\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/staff/role.vue\n// module id = 710\n// module chunks = 7","/**\n * Created by guo\n * 角色相关api\n */\nimport * as API from './'\n\nexport default {\n\n  //查询获取role列表(通过page分页)\n  findList: params => {\n    return API.GET('/api/v1/role/list', params)\n  },\n\n  //查询获取permission列表\n  permissionsList: params => {\n    return API.GET('/api/v1/permissions/list', params)\n  },\n\n  permissionsUpdate: (id, params) => {\n    return API.POST(`/api/v1/role/permissions/update/${id}`, params)\n  },\n\n  permissionsGet: (id, params) => {\n    return API.GET(`/api/v1/role/permissions/${id}`, params)\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/api_role.js","<template>\n  <el-row class=\"warp\">\n    <el-col :span=\"24\" class=\"warp-breadcrum\">\n      <el-breadcrumb separator=\"/\">\n        <el-breadcrumb-item :to=\"{ path: '/' }\"><b>首页</b></el-breadcrumb-item>\n        <el-breadcrumb-item>系统管理</el-breadcrumb-item>\n        <el-breadcrumb-item>管理员列表</el-breadcrumb-item>\n      </el-breadcrumb>\n    </el-col>\n\n    <el-col :span=\"24\" class=\"warp-main\" v-loading=\"loading\" element-loading-text=\"拼命加载中\">\n      <!--列表-->\n      <el-table stripe :data=\"users\" highlight-current-row style=\"width: 100%;\">\n        <el-table-column type=\"index\" width=\"40\"></el-table-column>\n        <el-table-column prop=\"name\" label=\"角色\" width=\"120\" sortable></el-table-column>\n        <el-table-column prop=\"remark\" label=\"备注\" sortable></el-table-column>\n        <el-table-column fixed=\"right\" width=\"280\" label=\"操作\">\n          <template slot-scope=\"scope\">\n            <el-button size=\"small\"  @click=\"showPermissionsDialog(scope.$index, scope.row)\">编辑权限</el-button>\n            <el-button type=\"danger\" @click=\"delRole(scope.$index, scope.row)\" size=\"small\">删除</el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n\n      <!--工具条-->\n      <el-col :span=\"24\" class=\"toolbar\">\n        <el-pagination layout=\"prev, pager, next\" @current-change=\"handleCurrentChange\" :page-size=\"limit\"\n                       :total=\"total\" style=\"float:right;\">\n        </el-pagination>\n      </el-col>\n\n      <el-dialog title=\"编辑权限\" :visible.sync=\"editPermissionsFormVisible\" :close-on-click-modal=\"false\">\n        <input type=\"hidden\" :value=\"editId\"/>\n\n        <el-tree\n          :data=\"treeData\"\n          show-checkbox\n          default-expand-all\n          node-key=\"id\"\n          ref=\"tree\"\n          highlight-current\n          :props=\"defaultProps\">\n        </el-tree>\n\n        <div slot=\"footer\" class=\"dialog-footer\">\n          <el-button @click.native=\"editPermissionsFormVisible = false\">取消</el-button>\n          <el-button type=\"primary\" @click.native=\"editPermissionsSubmit\">提交</el-button>\n        </div>\n      </el-dialog>\n\n    </el-col>\n  </el-row>\n</template>\n<script>\n  import API from '../../api/api_role';\n  import {getPermissions} from '@/utils/session';\n\n  export default {\n    data() {\n      return {\n        //过滤相关数据\n        loading: false,\n        permissionsEditLoading: false,\n        users: [],\n        total: 0,\n        page: 1,\n        limit: 10,\n        currentPage: 1,\n\n        //编辑相关数据\n        editFormVisible: false, //编辑界面是否显示\n        editPermissionsFormVisible: false, //权限编辑界面是否显示\n        editId: 0,\n        treeData: [],\n        defaultProps: {\n          children: 'children',\n          label: 'name'\n        }\n      }\n    },\n    methods: {\n      handleSizeChange(val) {\n        this.limit = val();\n        this.search();\n      },\n      handleCurrentChange(val) {\n        this.page = val;\n        this.search();\n      },\n      handleSearch() {\n        this.total = 0;\n        this.page = 1;\n        this.search();\n      },\n      //获取用户列表\n      search: function () {\n        let that = this;\n        let params = {\n          pageNum: that.page,\n          pageSize: that.limit\n        };\n\n        that.loading = true;\n        API.findList(params).then(function (result) {\n          that.loading = false;\n          if (result && result.data) {\n            that.total = result.data.total;\n            that.users = result.data.list;\n          }\n        }, function (err) {\n          that.loading = false;\n          that.$message.error({showClose: true, message: err.toString(), duration: 2000});\n        }).catch(function (error) {\n          that.loading = false;\n          console.log(error);\n          that.$message.error({showClose: true, message: '请求出现异常', duration: 2000});\n        });\n      },\n\n      handleDefaultPermissions() {\n        let that = this;\n        let params = {\n          pageNum: that.page,\n          pageSize: 100\n        };\n        //获取树结构\n        API.permissionsList(params).then(function (result) {\n          console.log(\"获取树结构\");\n          that.permissionsLoading = false;\n          if (result && result.errorCode == 0) {\n            let list = result.data.list;\n            //深度2\n            let data = [];\n            //一级菜单\n            for (var i in list) {\n              let item = list[i];\n              if (Number(item.level) == 1) {\n                if (item.redirect == null) {\n                  delete item.redirect;\n                }\n\n                item.children = [];\n                data.push(item);\n              }\n            }\n            //二级菜单\n            for (var i in list) {\n              let item = list[i];\n              if (Number(item.level) == 2) {\n                let p = {};\n                for (let d in data) {\n                  let dobj = data[d];\n                  if (dobj.id == item.parentId) {\n                    p = dobj;\n                    break;\n                  }\n                }\n                if (item.redirect == null) {\n                  delete item.redirect;\n                }\n                p.children.push(item)\n              }\n            }\n            that.treeData = data;\n          }\n        }, function (err) {\n          that.$message.error({showClose: true, message: err.toString(), duration: 2000});\n        }).catch(function (error) {\n          that.$message.error({showClose: true, message: '请求出现异常', duration: 2000});\n        });\n      },\n\n      //显示编辑界面\n      showEditDialog: function (index, row) {\n        this.editFormVisible = true;\n        console.log(row);\n      },\n\n      showPermissionsDialog: function (index, row) {\n        this.editPermissionsFormVisible = true;\n        this.editId = row.id;\n\n        this.permissionsEditLoading = true;\n      },\n\n      editPermissionsSubmit: function () {\n        let that = this;\n        let para = that.$refs.tree.getCheckedKeys();\n\n        that.loading = true;\n        API.permissionsUpdate(that.editId, {'keys': para.toString()}).then(function (result) {\n          that.loading = false;\n\n          if (result && parseInt(result.errorCode) == 0) {\n            that.$message.success({showClose: true, message: '修改成功', duration: 2000});\n            that.editPermissionsFormVisible = false;\n          } else {\n            that.$message.error({showClose: true, message: '修改失败', duration: 2000});\n          }\n        }, function (err) {\n          that.loading = false;\n          that.$message.error({showClose: true, message: err.toString(), duration: 2000});\n        }).catch(function (error) {\n          that.loading = false;\n          console.log(error);\n          that.$message.error({showClose: true, message: '请求出现异常', duration: 2000});\n        });\n      }\n\n\n    },\n    mounted() {\n      this.handleSearch();\n      this.handleDefaultPermissions();\n    },\n    updated() {\n      let that = this;\n      //console.log(\"updated\" + that.$refs.tree);\n      if (that.permissionsEditLoading == true) {\n        //勾中角色的权限\n        API.permissionsGet(that.editId, {}).then((result) => {\n          console.log(JSON.stringify(result));\n          that.$refs.tree.setCheckedNodes(result.data);\n        });\n        /*let obj = [{\n          id: 2\n        }];\n        that.$refs.tree.setCheckedNodes(result);*/\n      }\n    }\n  }\n\n\n</script>\n<style scoped>\n\n</style>\n\n\n\n// WEBPACK FOOTER //\n// role.vue?60a8fed6","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \"\", \"\", {\"version\":3,\"sources\":[],\"names\":[],\"mappings\":\"\",\"file\":\"role.vue\",\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/css-loader?{\"minimize\":true,\"sourceMap\":true}!./~/vue-loader/lib/style-compiler?{\"id\":\"data-v-357af519\",\"scoped\":true,\"hasInlineConfig\":false}!./~/vue-loader/lib/selector.js?type=styles&index=0!./src/components/staff/role.vue\n// module id = 864\n// module chunks = 7","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/index.js?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index.js?{\\\"id\\\":\\\"data-v-357af519\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./role.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\")(\"5de68f1c\", content, true);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/extract-text-webpack-plugin/loader.js?{\"omit\":1,\"remove\":true}!./~/vue-style-loader!./~/css-loader?{\"minimize\":true,\"sourceMap\":true}!./~/vue-loader/lib/style-compiler?{\"id\":\"data-v-357af519\",\"scoped\":true,\"hasInlineConfig\":false}!./~/vue-loader/lib/selector.js?type=styles&index=0!./src/components/staff/role.vue\n// module id = 876\n// module chunks = 7","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('el-row', {\n    staticClass: \"warp\"\n  }, [_c('el-col', {\n    staticClass: \"warp-breadcrum\",\n    attrs: {\n      \"span\": 24\n    }\n  }, [_c('el-breadcrumb', {\n    attrs: {\n      \"separator\": \"/\"\n    }\n  }, [_c('el-breadcrumb-item', {\n    attrs: {\n      \"to\": {\n        path: '/'\n      }\n    }\n  }, [_c('b', [_vm._v(\"首页\")])]), _vm._v(\" \"), _c('el-breadcrumb-item', [_vm._v(\"系统管理\")]), _vm._v(\" \"), _c('el-breadcrumb-item', [_vm._v(\"管理员列表\")])], 1)], 1), _vm._v(\" \"), _c('el-col', {\n    directives: [{\n      name: \"loading\",\n      rawName: \"v-loading\",\n      value: (_vm.loading),\n      expression: \"loading\"\n    }],\n    staticClass: \"warp-main\",\n    attrs: {\n      \"span\": 24,\n      \"element-loading-text\": \"拼命加载中\"\n    }\n  }, [_c('el-table', {\n    staticStyle: {\n      \"width\": \"100%\"\n    },\n    attrs: {\n      \"stripe\": \"\",\n      \"data\": _vm.users,\n      \"highlight-current-row\": \"\"\n    }\n  }, [_c('el-table-column', {\n    attrs: {\n      \"type\": \"index\",\n      \"width\": \"40\"\n    }\n  }), _vm._v(\" \"), _c('el-table-column', {\n    attrs: {\n      \"prop\": \"name\",\n      \"label\": \"角色\",\n      \"width\": \"120\",\n      \"sortable\": \"\"\n    }\n  }), _vm._v(\" \"), _c('el-table-column', {\n    attrs: {\n      \"prop\": \"remark\",\n      \"label\": \"备注\",\n      \"sortable\": \"\"\n    }\n  }), _vm._v(\" \"), _c('el-table-column', {\n    attrs: {\n      \"fixed\": \"right\",\n      \"width\": \"280\",\n      \"label\": \"操作\"\n    },\n    scopedSlots: _vm._u([{\n      key: \"default\",\n      fn: function(scope) {\n        return [_c('el-button', {\n          attrs: {\n            \"size\": \"small\"\n          },\n          on: {\n            \"click\": function($event) {\n              _vm.showPermissionsDialog(scope.$index, scope.row)\n            }\n          }\n        }, [_vm._v(\"编辑权限\")]), _vm._v(\" \"), _c('el-button', {\n          attrs: {\n            \"type\": \"danger\",\n            \"size\": \"small\"\n          },\n          on: {\n            \"click\": function($event) {\n              _vm.delRole(scope.$index, scope.row)\n            }\n          }\n        }, [_vm._v(\"删除\")])]\n      }\n    }])\n  })], 1), _vm._v(\" \"), _c('el-col', {\n    staticClass: \"toolbar\",\n    attrs: {\n      \"span\": 24\n    }\n  }, [_c('el-pagination', {\n    staticStyle: {\n      \"float\": \"right\"\n    },\n    attrs: {\n      \"layout\": \"prev, pager, next\",\n      \"page-size\": _vm.limit,\n      \"total\": _vm.total\n    },\n    on: {\n      \"current-change\": _vm.handleCurrentChange\n    }\n  })], 1), _vm._v(\" \"), _c('el-dialog', {\n    attrs: {\n      \"title\": \"编辑权限\",\n      \"visible\": _vm.editPermissionsFormVisible,\n      \"close-on-click-modal\": false\n    },\n    on: {\n      \"update:visible\": function($event) {\n        _vm.editPermissionsFormVisible = $event\n      }\n    }\n  }, [_c('input', {\n    attrs: {\n      \"type\": \"hidden\"\n    },\n    domProps: {\n      \"value\": _vm.editId\n    }\n  }), _vm._v(\" \"), _c('el-tree', {\n    ref: \"tree\",\n    attrs: {\n      \"data\": _vm.treeData,\n      \"show-checkbox\": \"\",\n      \"default-expand-all\": \"\",\n      \"node-key\": \"id\",\n      \"highlight-current\": \"\",\n      \"props\": _vm.defaultProps\n    }\n  }), _vm._v(\" \"), _c('div', {\n    staticClass: \"dialog-footer\",\n    attrs: {\n      \"slot\": \"footer\"\n    },\n    slot: \"footer\"\n  }, [_c('el-button', {\n    nativeOn: {\n      \"click\": function($event) {\n        _vm.editPermissionsFormVisible = false\n      }\n    }\n  }, [_vm._v(\"取消\")]), _vm._v(\" \"), _c('el-button', {\n    attrs: {\n      \"type\": \"primary\"\n    },\n    nativeOn: {\n      \"click\": function($event) {\n        _vm.editPermissionsSubmit($event)\n      }\n    }\n  }, [_vm._v(\"提交\")])], 1)], 1)], 1)], 1)\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-357af519\"}!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/staff/role.vue\n// module id = 888\n// module chunks = 7"],"sourceRoot":""}